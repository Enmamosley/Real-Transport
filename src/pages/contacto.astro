---
import Base from "@/layouts/Base.astro";
import CallToAction from "@/partials/CallToAction.astro";
import type { CollectionEntry } from "astro:content";
import { getEntry } from "astro:content";

const contact = (await getEntry(
  "contact",
  "-index"
)) as CollectionEntry<"contact">;
const { title, description, meta_title } = contact.data;
const call_to_action = (await getEntry(
  "callToAction",
  "call-to-action"
)) as CollectionEntry<"callToAction">;
---

<Base
  title={title}
  meta_title={meta_title}
  description={description}
  image={""}
>
  <section class="section bg-light">
    <div class="container">
      <h1 class="text-center" data-aos="fade-up-sm">Contáctanos</h1>
    </div>
  </section>

  <section class="section pb-0">
    <div class="container">
      <div class="row justify-center">
        <div class="lg:col-8">
          <!-- Mensaje de éxito -->
          <div id="success-message" class="hidden mb-6 p-4 bg-green-100 border border-green-400 text-green-700 rounded-lg">
            <h3 class="font-semibold">¡Mensaje enviado exitosamente!</h3>
            <p>Gracias por contactarnos. Te responderemos a la brevedad posible.</p>
          </div>
          
          <form action="https://formsubmit.co/contacto@realtransport.com.mx" method="POST">
            <!-- FormSubmit Configuration -->
            <input type="hidden" name="_subject" value="Nuevo mensaje desde Real Transport">
            <input type="hidden" name="_captcha" value="false">
            <input type="hidden" name="_next" value="http://localhost:4321/contacto?success=true">
            <input type="hidden" name="_template" value="table">
            
            <div class="sm:flex justify-between gap-10">
              <div
                class="mb-6 w-full"
                data-aos="fade-up-sm"
                data-aos-delay="100"
              >
                <label for="name" class="form-label"> Nombre Completo </label>
                <input
                  id="name"
                  name="name"
                  class="form-input w-full bg-tertiary/5!"
                  placeholder="Nombre"
                  type="text"
                  required
                />
              </div>
              <div
                class="mb-6 w-full"
                data-aos="fade-up-sm"
                data-aos-delay="150"
              >
                <label for="mobileNumber" class="form-label">
                  Número de Teléfono
                </label>
                <input
                  id="mobileNumber"
                  name="telefono"
                  class="form-input w-full bg-tertiary/5!"
                  placeholder="Número de Teléfono"
                  type="tel"
                  required
                />
              </div>
            </div>
            <div class="mb-6" data-aos="fade-up-sm" data-aos-delay="200">
              <label for="email" class="form-label"> Correo Electrónico </label>
              <input
                id="email"
                name="email"
                class="form-input bg-tertiary/5!"
                placeholder="Correo Electrónico"
                type="email"
                required
              />
            </div>
            <div class="mb-6" data-aos="fade-up-sm" data-aos-delay="250">
              <label for="message" class="form-label"> Mensaje </label>
              <textarea
                id="message"
                name="mensaje"
                class="form-input bg-tertiary/5!"
                placeholder="Escriba su mensaje"
                rows="3"
                required></textarea>
            </div>
            <button
              type="submit"
              class="btn btn-primary"
              data-aos="fade-up-sm"
              data-aos-delay="300">Enviar Mensaje</button
            >
          </form>
        </div>
      </div>
    </div>
  </section>

  <CallToAction call_to_action={call_to_action} />
</Base>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Verificar si hay parámetro de éxito en la URL
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get('success') === 'true') {
      const successMessage = document.getElementById('success-message');
      if (successMessage) {
        successMessage.classList.remove('hidden');
        // Scroll hacia el mensaje
        successMessage.scrollIntoView({ behavior: 'smooth' });
      }
    }
  });
</script>
